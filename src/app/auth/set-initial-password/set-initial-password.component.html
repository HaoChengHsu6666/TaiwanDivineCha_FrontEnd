<!-- src/app/auth/set-initial-password/set-initial-password.component.html -->

<mat-card class="set-password-card">
  <mat-card-header>
    <mat-card-title>設定您的帳戶密碼</mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <form [formGroup]="setPasswordForm" (ngSubmit)="onSubmit()">
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>新密碼</mat-label>
        <input matInput type="password" formControlName="newPassword" placeholder="輸入新密碼">
        <mat-error *ngIf="newPasswordControl?.hasError('required') && newPasswordControl?.touched">
          新密碼是必填項。
        </mat-error>
        <mat-error *ngIf="newPasswordControl?.hasError('minlength') && newPasswordControl?.touched">
          密碼至少需要 {{ newPasswordControl?.errors?.['minlength']?.requiredLength }} 個字符。
        </mat-error>
        <mat-error *ngIf="newPasswordControl?.hasError('pattern') && newPasswordControl?.touched">
          密碼必須包含大小寫字母、數字和特殊字符。
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width">
        <mat-label>確認密碼</mat-label>
        <input matInput type="password" formControlName="confirmPassword" placeholder="再次輸入新密碼">
        <mat-error *ngIf="confirmPasswordControl?.hasError('required') && confirmPasswordControl?.touched">
          確認密碼是必填項。
        </mat-error>
        <mat-error *ngIf="setPasswordForm.hasError('mismatch') && confirmPasswordControl?.touched">
          密碼不一致。
        </mat-error>
      </mat-form-field>

      <button mat-raised-button color="primary" type="submit" [disabled]="setPasswordForm.invalid || isLoading" class="full-width">
        <span *ngIf="!isLoading">設定密碼</span>
        <mat-spinner *ngIf="isLoading" [diameter]="20" color="accent"></mat-spinner>
      </button>

      <p *ngIf="message" class="info-message">{{ message }}</p>
    </form>
  </mat-card-content>
</mat-card>